<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>博客后台 | Decap CMS</title>
    <style>
        /* 样式保持不变... */
    </style>
</head>
<body>
    <div id="loading">
        <div class="spinner"></div>
        <h2>正在加载内容管理系统...</h2>
        <p id="load-status">初始化中，请稍候</p>
    </div>
    <div id="error" class="error"></div>
    <div id="nc-root"></div>

    <script>
        var CDN_SOURCES = [
            'https://cdn.bootcdn.net/ajax/libs/decap-cms/3.3.0/decap-cms.min.js',
            'https://unpkg.zhimg.com/decap-cms@3.3.0/dist/decap-cms.js',
            'https://cdn.staticfile.org/decap-cms/3.3.0/decap-cms.min.js',
            'https://cdn.jsdelivr.net/npm/decap-cms@3.3.0/dist/decap-cms.js'  // 原版作为最后备选
        ];
        
        var currentCDNIndex = 0;
        
        function updateStatus(msg) {
            var statusEl = document.getElementById('load-status');
            if (statusEl) {
                statusEl.textContent = msg;
            }
            console.log('Status:', msg);
        }
        
        function showError(msg) {
            console.error('CMS Error:', msg);
            document.getElementById('loading').style.display = 'none';
            var errorEl = document.getElementById('error');
            errorEl.innerHTML = '<strong>错误：</strong>' + msg;
            errorEl.style.display = 'block';
        }
        
        function tryLoadCDN() {
            if (currentCDNIndex >= CDN_SOURCES.length) {
                showError('所有CDN源都加载失败，请检查网络连接');
                return;
            }
            
            var cdnUrl = CDN_SOURCES[currentCDNIndex];
            updateStatus('正在从CDN加载: ' + (currentCDNIndex + 1) + '/' + CDN_SOURCES.length);
            
            var script = document.createElement('script');
            script.src = cdnUrl;
            
            script.onload = function() {
                console.log('CDN加载成功:', cdnUrl);
                updateStatus('CMS库加载成功，正在初始化...');
                initCMS();
            };
            
            script.onerror = function() {
                console.log('CDN加载失败:', cdnUrl);
                currentCDNIndex++;
                setTimeout(tryLoadCDN, 1000); // 1秒后尝试下一个
            };
            
            document.head.appendChild(script);
        }
        
        function initCMS() {
            if (typeof CMS === 'undefined') {
                showError('CMS库加载失败');
                return;
            }
            
            try {
                CMS.init();
                setTimeout(function() {
                    document.getElementById('loading').style.display = 'none';
                }, 1000);
            } catch (err) {
                showError('初始化失败: ' + err.message);
            }
        }
        
        // 开始加载
        tryLoadCDN();
    </script>
</body>
</html>