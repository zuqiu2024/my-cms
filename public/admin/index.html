<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åšå®¢ç®¡ç†åå°</title>
    
    <!-- ç›´æ¥ä½¿ç”¨å®˜æ–¹CDNï¼Œæ— ä»»ä½•å¤‡ç”¨ -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    
    <style>
        /* æç®€æ ·å¼ï¼Œé¿å…ä»»ä½•å†²çª */
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            height: 100vh;
        }
        
        #root {
            height: 100%;
        }
        
        .vpn-notice {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #ff9800;
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 14px;
            z-index: 10000;
        }
        
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #666;
        }
        
        .error {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        .retry-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- VPNæé†’ï¼ˆåªåœ¨éVPNç¯å¢ƒæ˜¾ç¤ºï¼‰ -->
    <div id="vpn-notice" class="vpn-notice" style="display: none;">
        ğŸ”’ æ­¤é¡µé¢éœ€è¦VPNæ‰èƒ½æ­£å¸¸è®¿é—®ã€‚è¯·ç¡®ä¿å·²è¿æ¥VPNã€‚
    </div>
    
    <!-- åŠ è½½æç¤º -->
    <div id="loading" class="loading">
        <h3>æ­£åœ¨åŠ è½½ç®¡ç†åå°</h3>
        <p>è¯·ç¡®ä¿VPNè¿æ¥æ­£å¸¸...</p>
    </div>
    
    <!-- é”™è¯¯æç¤º -->
    <div id="error" class="error">
        <h3>åŠ è½½å¤±è´¥</h3>
        <p id="error-msg"></p>
        <button class="retry-btn" onclick="location.reload()">é‡æ–°åŠ è½½</button>
        <p style="margin-top: 15px; font-size: 14px; color: #666;">
            å¦‚æœå¤šæ¬¡é‡è¯•å¤±è´¥ï¼Œè¯·ï¼š<br>
            1. æ£€æŸ¥VPNè¿æ¥<br>
            2. åˆ·æ–°VPNèŠ‚ç‚¹<br>
            3. ç­‰å¾…å‡ åˆ†é’Ÿåå†è¯•
        </p>
    </div>
    
    <!-- Decap CMSå®¹å™¨ -->
    <div id="nc-root"></div>
    
    <script>
        // æç®€åˆå§‹åŒ–é€»è¾‘
        (function() {
            console.log('å¼€å§‹åŠ è½½Decap CMS...');
            
            // æ£€æµ‹æ˜¯å¦å¯èƒ½åœ¨å›½å†…ç½‘ç»œç¯å¢ƒ
            function checkNetwork() {
                // ç®€å•çš„ç½‘ç»œæ£€æµ‹
                var timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                var language = navigator.language || navigator.userLanguage;
                
                // å¦‚æœæ—¶åŒºæ˜¯äºšæ´²æ—¶åŒºä¸”è¯­è¨€æ˜¯ä¸­æ–‡ï¼Œæç¤ºå¯èƒ½éœ€è¦VPN
                if (timezone.includes('Asia') && language.includes('zh')) {
                    document.getElementById('vpn-notice').style.display = 'block';
                }
            }
            
            // åˆå§‹åŒ–CMS
            function initCMS() {
                try {
                    console.log('æ­£åœ¨åˆå§‹åŒ–CMS...');
                    
                    if (typeof CMS === 'undefined') {
                        throw new Error('CMSåº“æœªåŠ è½½ï¼Œè¯·æ£€æŸ¥VPNè¿æ¥');
                    }
                    
                    // åˆå§‹åŒ–CMS
                    CMS.init();
                    
                    // éšè—åŠ è½½æç¤º
                    setTimeout(function() {
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('vpn-notice').style.display = 'none';
                    }, 1000);
                    
                    console.log('CMSåˆå§‹åŒ–æˆåŠŸ');
                    
                } catch (error) {
                    console.error('CMSåˆå§‹åŒ–å¤±è´¥:', error);
                    
                    // æ˜¾ç¤ºé”™è¯¯
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('error-msg').textContent = error.message;
                    document.getElementById('error').style.display = 'block';
                }
            }
            
            // é¡µé¢åŠ è½½å®Œæˆåçš„å¤„ç†
            document.addEventListener('DOMContentLoaded', function() {
                checkNetwork();
                
                // ç»™CMSåº“10ç§’åŠ è½½æ—¶é—´
                var waitForCMS = setInterval(function() {
                    if (typeof CMS !== 'undefined') {
                        clearInterval(waitForCMS);
                        initCMS();
                    }
                }, 100);
                
                // 20ç§’åè¶…æ—¶
                setTimeout(function() {
                    if (typeof CMS === 'undefined') {
                        clearInterval(waitForCMS);
                        
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('error-msg').textContent = 'CMSåº“åŠ è½½è¶…æ—¶ï¼Œè¯·ç¡®ä¿VPNè¿æ¥æ­£å¸¸';
                        document.getElementById('error').style.display = 'block';
                    }
                }, 20000);
            });
            
            // å…¨å±€é”™è¯¯æ•è·
            window.addEventListener('error', function(event) {
                console.error('å…¨å±€é”™è¯¯:', event.error);
                
                // å¦‚æœæ˜¯è„šæœ¬åŠ è½½é”™è¯¯
                if (event.target && event.target.tagName === 'SCRIPT') {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('error-msg').textContent = 'è„šæœ¬åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥VPNè¿æ¥';
                    document.getElementById('error').style.display = 'block';
                }
            });
            
        })();
    </script>
</body>
</html>