<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>博客内容管理后台</title>
    <!-- 1. 引入 Decap CMS -->
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    <!-- 2. 将配置直接内嵌在页面中，这是最可靠的方式 -->
    <script>
        // 重要：在 CMS 脚本加载前，将配置写入全局变量
        window.CMS_CONFIG = {
            backend: {
                name: "github",
                repo: "zuqiu2024/zxx", // 你的仓库
                branch: "master",       // 请再次确认分支名
                base_url: "https://zhanxx1.de5.net", // 必须与GitHub OAuth设置一致
                auth_scope: "repo",     // 请求的权限
                api_root: "https://api.github.com"
            },
            media_folder: "public/images",
            public_folder: "/images",
            collections: [
                {
                    name: "posts",
                    label: "文章",
                    folder: "src/content/posts",
                    create: true,
                    slug: "{{slug}}",
                    fields: [
                        { label: "标题", name: "title", widget: "string" },
                        { label: "发布日期", name: "published", widget: "datetime", format: "YYYY-MM-DD" },
                        { label: "描述", name: "description", widget: "text" },
                        { label: "标签", name: "tags", widget: "list" },
                        { label: "封面图片", name: "image", widget: "string" },
                        { label: "作者", name: "author", widget: "string", default: "展" },
                        { label: "正文", name: "body", widget: "markdown" }
                    ]
                }
            ]
        };
        // 3. 当CMS库加载后，自动使用上述配置初始化
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof CMS !== 'undefined') {
                CMS.init({ config: window.CMS_CONFIG });
                console.log('CMS已使用内嵌配置初始化。');
            }
        });
    </script>
    <style>
        /* 可选：添加一个加载提示 */
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin: 0; }
        #loading { padding: 40px; text-align: center; color: #666; }
    </style>
</head>
<body>
    <!-- 4. 加载提示（CMS加载成功后会被替换） -->
    <div id="loading">
        <p>正在加载内容管理器...</p>
    </div>
    <!-- 5. CMS的挂载点 -->
    <div id="nc-root"></div>
    <script>
        // 可选：加载成功后隐藏提示
        setTimeout(function() {
            var loadingEl = document.getElementById('loading');
            if (loadingEl && document.getElementById('nc-root').children.length > 0) {
                loadingEl.style.display = 'none';
            }
        }, 2000);
    </script>
</body>
</html>